"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.parseStdoutCommand = void 0;
const commandsEscaping_1 = require("../utils/commandsEscaping");
const stdoutCommands_1 = require("./stdoutCommands");
function parseStdoutCommand(str) {
    const regexpResult = stdoutCommands_1.stdoutCmdWithParamRegexp.exec(str);
    if (!regexpResult) {
        return undefined;
    }
    // noinspection JSUnusedLocalSymbols
    const [cmd, cmdName, cmdProperties, cmdMessage] = regexpResult;
    let properties = {};
    if (cmdProperties) {
        cmdProperties.trimLeft().split(',').forEach(expression => {
            const expressionParts = expression.split('=');
            if (expressionParts.length === 2) {
                let [propKey, propValue] = expressionParts;
                propValue = (0, commandsEscaping_1.unescapePropertyValue)(propValue);
                properties[propKey] = propValue;
            }
        });
    }
    return {
        command: cmdName,
        properties,
        message: cmdMessage ? (0, commandsEscaping_1.unescapeCommandValue)(cmdMessage) : undefined
    };
}
exports.parseStdoutCommand = parseStdoutCommand;
//# sourceMappingURL=parseStdoutCommand.js.map